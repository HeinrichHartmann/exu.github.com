---
layout: post
title: Using Symfony2 Console as standalone component
date: 2013-05-10 18:42:42 UTC UTC
updated: 2013-05-10 18:42:42 UTC UTC
comments: true
category: programming
tags: [symfony, component, standalone, shell, console]
---
{% include JB/setup %}

<p>
All files are located on GitHub <a href="https://github.com/exu/symfony2-console-standalone">Symfony2 Console as standalone component</a>
</p>
<p>
To use symfony console you should create <code>composer.json</code> file and add <code>symfony/console</code> component
</p>



<pre class="example">{
    "autoload": {
        "psr-0": {"": "src/"}
    },

    "require": {
        "symfony/console": "dev-master"
    }
}
</pre>


<p>
You should replace "<code>dev-master</code>" to current stable version (I'm trying whats new in development branch).
</p>
<p>
I'm using composer autoloader, so in this example all classes will be loaded from <code>src</code> directory,
you can change it to other dir (in <code>composer.json</code>)
</p>


<p>
Next run
</p>


<pre class="example">$ composer update
</pre>


<p>
to install dependencies in your new project.
</p>


<p>
Next thing to do is Your new shiny command loader.
Put it in <code>bin/console</code> file - or whatever you want - but if you change
directory position remember that you should adjust your paths
</p>



<pre class="example">#!/usr/bin/env php
&lt;?php

date_default_timezone_set('UTC');

set_time_limit(0);

(@include_once __DIR__ . '/../vendor/autoload.php') || @include_once __DIR__ . '/../../../autoload.php';

use Symfony\Component\Console\Application;

$app = new Application('Sample Console Component Based Application', '6.6.6');

foreach(glob(__DIR__ . '/../src/Command/*Command.php') as $FileName) {
    $className = "Command\\" . rtrim(basename($FileName), ".php");
    $app-&gt;addCommands(array(
        new $className,
    ));
}

$app-&gt;run();
</pre>



<p>
Finally create your new command file (src) for example:
</p>



<pre class="example">&lt;?php
/**
 * @author    Jacek Wysocki &lt;jacek.wysocki@gmail.com&gt;
 */
namespace Command;

use Symfony\Component\Console\Command\Command;
use Symfony\Component\Console\Input\InputInterface;
use Symfony\Component\Console\Output\OutputInterface;

class Test2Command extends Command
{
    protected function configure()
    {
        $this
            -&gt;setName('say:nothing')
            -&gt;setDescription('Says nothing');
        ;
    }

    protected function execute(InputInterface $input, OutputInterface $output)
    {
        $output-&gt;writeln("nothing &lt;info&gt;nothing&lt;/info&gt; &lt;error&gt;nothing&lt;/error&gt;");
    }
}
</pre>


<p>
Thats all, command loader should detect this file and load it. You can use your command by running
<code>php bin/console say:nothing</code>.
</p>


<p>
You can put other commands in <code>src/Command</code>
directory try save content below as <code>src/Command/TestCommand.php</code>
</p>





<pre class="example">&lt;?php
/**
 * @author    Jacek Wysocki &lt;jacek.wysocki@gmail.com&gt;
 */

namespace Command;

use Symfony\Component\Console\Command\Command;
use Symfony\Component\Console\Input\InputArgument;
use Symfony\Component\Console\Input\InputInterface;
use Symfony\Component\Console\Input\InputOption;
use Symfony\Component\Console\Output\OutputInterface;

class TestCommand extends Command
{
    protected function configure()
    {
        $this
            -&gt;setName('say:mynamebitch')
            -&gt;setDescription('Greet someone with colors')
            -&gt;addArgument('name', InputArgument::OPTIONAL, 'Who do you want to greet?')
            -&gt;addOption('yell', null, InputOption::VALUE_NONE, 'If set, the task will yell in uppercase letters')
        ;
    }

    protected function execute(InputInterface $input, OutputInterface $output)
    {
        $name = $input-&gt;getArgument('name');
        if ($name) {
            $text = 'Hello '.$name;
        } else {
            $text = 'Hello';
        }

        if ($input-&gt;getOption('yell')) {
            $text = strtoupper($text);
        }

        $output-&gt;writeln("$text in green '&lt;info&gt;$text&lt;/info&gt;' and in red: &lt;error&gt;$text&lt;/error&gt;");
    }
}
</pre>


<p>
and then run:
</p>



<pre class="example">bin/console say:mynamebitch Jacek
</pre>


<p>
You will get some nice colorized output.
</p>

<p>
Enjoy!
</p>
